import"../chunks/CWj6FrbW.js";import{i as G}from"../chunks/WWVtWIcG.js";import{e as J,f as U,j as f,t as O,g as u,m as T,s as F,k as g,r as _,n as x}from"../chunks/4Vjq8Xjj.js";import{t as B,e as E,a as P,b as W,s as Z}from"../chunks/B4dHhGZh.js";import{r as V}from"../chunks/B0CBmk3k.js";import"../chunks/CCLTtN7-.js";import{F as H,C as K,P as M,a as N,_ as Q}from"../chunks/BjFtRYDz.js";import{P as X}from"../chunks/Cg-cZ5-n.js";import{J as Y}from"../chunks/FGvmAy_r.js";import{p as ee}from"../chunks/yOqKe9X7.js";var k=V(()=>Q),te=B('<main class="flex flex-col justify-center items-center pt-5"><div class="w-1/2"><!></div> <div class="w-1/2 mt-12 flex flex-col gap-12"><button id="ocr_btn" type="button" class=" w-full btn preset-filled-primary-500" disabled>Convert To JPG</button> <!> <a id="file_downloader" class="btn preset-filled-success-500 hidden">Download images zip</a></div></main>');function me($,j){J(j,!1),ee.set("PDF to JPG");let z="https://unpkg.com/pdfjs-dist@5.0.375/build/pdf.worker.min.mjs",b=new Y,n,i=T(0),l;async function S(t){k(k().workerSrc=z);const o=new FileReader;return o.readAsArrayBuffer(t),new Promise(a=>{o.onload=async()=>{const e=o.result,s=await pdfjsLib.getDocument({data:e}).promise;let h=[];for(let d=1;d<=s.numPages;d++){const y=await s.getPage(d),m=y.getViewport({scale:2}),r=document.createElement("canvas"),I=r.getContext("2d");r.width=m.width,r.height=m.height,await y.render({canvasContext:I,viewport:m}).promise,h.push(r.toDataURL("image/png"))}a(h)}})}async function R(t,o){const e=await(await fetch(t)).blob();return new File([e],o,{type:"image/jpg"})}async function A(t){const o=b.folder("images_folder");console.log(t),t.forEach(e=>{o.file(e.name+".jpg",e)}),console.log(o);let a=await o.generateAsync({type:"blob"});return b.remove("images_folder"),a}async function C(){n=[],n[0]=l,console.log(n),g(i,null);let t=await S(n[0]);console.log(t);let o=[];for(let s=0;s<t.length;s++)console.log(t[s]),o.push(await R(t[s],l.name.split(".")[0]+"_page_"+(s+1)));console.log(o);let a=await A(o);const e=document.querySelector("#file_downloader");if(e.download!==void 0){const s=URL.createObjectURL(a);e.setAttribute("href",s),e.setAttribute("download",l.name.split(".")[0])}g(i,100),document.querySelector("#file_downloader").classList.remove("hidden")}function L(t){t.acceptedFiles.length>0?document.querySelector("#ocr_btn").disabled=!1:document.querySelector("#ocr_btn").disabled=!0,document.querySelector("#file_downloader").classList.add("hidden"),g(i,0),l=t.acceptedFiles[0]}G();var c=te(),p=f(c),q=f(p);H(q,{accept:"application/pdf",maxFiles:1,subtext:"Attach single PDF.",onFileChange:e=>{L(e)},classes:"w-full",iconInterface:e=>{N(e,{class:"size-8"})},iconFile:e=>{M(e,{class:"size-4"})},iconFileRemove:e=>{K(e,{class:"size-4"})},$$slots:{iconInterface:!0,iconFile:!0,iconFileRemove:!0}}),_(p);var w=F(p,2),v=f(w),D=F(v,2);X(D,{get value(){return u(i)},max:100,children:(t,o)=>{x();var a=W();O(()=>Z(a,u(i)!=null?u(i)+"%":"loading...")),P(t,a)},$$slots:{default:!0}}),x(2),_(w),_(c),E("click",v,()=>{C()}),P($,c),U()}export{me as component};
