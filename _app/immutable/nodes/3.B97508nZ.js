import{t as g,a as _,b as ne}from"../chunks/CaasTpf9.js";import{i as ie}from"../chunks/OKV8WO5A.js";import{e as ce,t as q,g as o,f as de,s as d,i as n,j as N,r as s,m as D,n as ue,k as u}from"../chunks/EW6ToMZV.js";import{e as b,s as S}from"../chunks/C-8pGi1S.js";import{i as fe}from"../chunks/CEyAtwe4.js";import{s as pe,r as ve,e as _e}from"../chunks/CEK-eUOh.js";import{b as me,A as be,a as ge}from"../chunks/Dmx_-YCo.js";import{F as we,A as he,a as xe,P as ye,C as Fe}from"../chunks/FiiLKZqd.js";import{P as Pe,s as $e}from"../chunks/BIL20m6r.js";import{P as Ae}from"../chunks/BJzTzqsX.js";var ke=g('<div class="btn preset-outlined-surface-500 h-48 w-full"><span>Upload Imagess</span> <!></div>'),qe=g('<div class="file-item border border-secondary-100 rounded-sm w-full flex items-center gap-5 p-2"><div class="controls flex"><button class="cursor-pointer btn preset-ghost-tertriary-500"><!></button> <button class="cursor-pointer btn preset-ghost-tertriary-500"><!></button></div> <div class="w-full flex gap-2"><!> <span> </span> <span> </span></div> <button><!></button></div>'),De=g('<div class="file-list p-2 flex flex-col gap-2 items-center"></div>'),Se=g('<main class="flex flex-col justify-center items-center  py-5"><div class="w-1/2 flex flex-col gap-5"><!> <div class="border-surface-500 border rounded-md h-full w-full"><!></div></div> <div class="w-1/2 mt-12 flex flex-col gap-12"><button id="ocr_btn" type="button" class=" w-full btn preset-filled-primary-500" disabled>Convert to PDF</button> <!> <label for="" class="label"><span class="label-text">PDF File Name</span> <input type="text" class="input"></label> <a id="file_downloader" class="btn preset-filled-success-500 hidden">Download pdf</a></div> <a href="/" class="btn preset-filled-surface-500 rounded-full h-12 w-12 fixed top-5 left-5"><!></a></main>');function Oe(O,R){ce(R,!1);let T,c=D(0),i=D([]),w=-1,f=D("");async function K(t,l,e){console.log(t);try{const a=await $e.createWorker("eng",1,{logger:p=>{console.log(p),p.status=""}}),{data:r}=await a.recognize(t,{pdfTitle:`part_${l}`},{pdf:!0});return console.log(r.text),T=r.pdf,a.terminate(),u(c,o(c)+1/e*100),u(c,o(c)>100?100:Math.floor(o(c))),Promise.resolve({pdf_raw:r.pdf,index:l})}catch(a){return console.error(a),Promise.reject(a)}}function V(t,l){const e=new Blob([new Uint8Array(t)],{type:"application/pdf"});return e.name=l,e.lastModifiedData=new Date,e}async function W(t){const l=new Ae;console.log(t),t.map(r=>{r.pdf_file=V(r.pdf,`${r.index}.pdf`)});for(let r=0;r<t.length;r++)await l.add(t[r].pdf_raw);await l.setMetadata({title:`${o(f)}`});let e=await l.saveAsBlob();console.log("error not above");const a=document.querySelector("#file_downloader");if(a.download!==void 0){const r=URL.createObjectURL(e);a.setAttribute("href",r),a.setAttribute("download",o(f).split(".")[0])}}function G(t){o(i).length==0&&document.querySelector("#file_downloader").classList.add("hidden"),u(c,0),console.log(t.acceptedFiles),u(i,J(t.acceptedFiles,o(i))),console.log(o(i)),u(f,o(f)==""?o(i)[0].name.split(".")[0]:o(f)),o(i).length>0?document.querySelector("#ocr_btn").disabled=!1:document.querySelector("#ocr_btn").disabled=!0}function L(t,l){const e=[...o(i)],a=l==="up"?t-1:t+1;console.log(e),e[t],document.querySelector("#file_downloader").classList.contains("hidden")||document.querySelector("#file_downloader").classList.add("hidden"),a>=0&&a<e.length&&([e[t],e[a]]=[e[a],e[t]],console.log(e),u(i,e))}function H(t){u(i,o(i).filter((l,e)=>e!=t))}function J(t,l){let e=[];return e=l,t.forEach((a,r)=>{w<r&&(console.log(a),e.push(a),w++)}),console.log(w),console.log(e),e}async function Q(){u(c,null);let t=o(i);console.log(t);let l=[];for(let e=0;e<t.length;e++)await K(t[e],e,t.length).then(a=>{l.push(a)});l.sort((e,a)=>e.index-a.index),await W(l),document.querySelector("#file_downloader").classList.remove("hidden"),u(c,o(c)<100?100:o(c)),console.log(l)}ie();var h=Se(),x=n(h),j=n(x);we(j,{maxFiles:50,accept:"image/jpeg",subtext:"Attach Images",onFileChange:t=>{G(t)},classes:"w-full",capture:!0,children:(t,l)=>{var e=ke(),a=d(n(e),2);xe(a,{}),s(e),_(t,e)},$$slots:{default:!0}});var M=d(j,2),X=n(M);{var Y=t=>{var l=De();_e(l,7,()=>o(i),(e,a)=>e.name+a,(e,a,r)=>{var p=qe(),P=n(p),v=n(P),te=n(v);be(te,{}),s(v);var m=d(v,2),oe=n(m);ge(oe,{}),s(m),s(P);var $=d(P,2),I=n($);ye(I,{});var A=d(I,2),ae=n(A,!0);s(A);var E=d(A,2),le=n(E);s(E),s($);var k=d($,2),re=n(k);Fe(re,{}),s(k),s(p),q(se=>{v.disabled=o(r)===0,m.disabled=o(r)===o(i).length-1,S(ae,o(a).name),S(le,`(${se??""} KB)`)},[()=>Math.round(o(a).size/1024)],N),b("click",v,()=>L(o(r),"up")),b("click",m,()=>L(o(r),"down")),b("click",k,()=>H(o(r))),_(e,p)}),s(l),_(t,l)};fe(X,t=>{o(i).length>0&&t(Y)})}s(M),s(x);var y=d(x,2),U=n(y),z=d(U,2);Pe(z,{get value(){return o(c)},max:100,children:(t,l)=>{ue();var e=ne();q(()=>S(e,o(c)!=null?o(c)+"%":"loading...")),_(t,e)},$$slots:{default:!0}});var F=d(z,2),C=d(n(F),2);ve(C),s(F);var Z=d(F,2);s(y);var B=d(y,2),ee=n(B);he(ee,{class:"size-8"}),s(B),s(h),q(t=>pe(Z,"download",t),[()=>o(f).split(".")[0]],N),b("click",U,()=>{Q()}),me(C,()=>o(f),t=>u(f,t)),_(O,h),de()}export{Oe as component};
